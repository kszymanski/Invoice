<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">
	<head><title>IGNORED</title></head>
	<body>
		<ui:composition template="/faces/templates/masterLayout.xhtml">
			<ui:define name="windowTitle">Roles</ui:define>
			<f:event type="preRenderView" listener="#{rolesList.refreshList()}"/>
			<ui:define name="content">
			<h:form id="form">
				<p:growl id="msgs" showDetail="true"/>
				<p:menubar id="menu">
					<p:menuitem value="Edytuj" icon="ui-icon-refresh" onclick="changeToEdit()" disabled="#{rolesList.selectedRole==null || !loginUser.user.role.addRole}"/>
					<p:menuitem id="btn" value="Zapisz"  actionListener="#{rolesList.selectedRole.updateRole()}" icon="ui-icon-disk" update="msgs" rendered="#{edit}" onsuccess="changeToView()"/>
					<p:menuitem value="Nowy" icon="ui-icon-document" onclick="addRoleDialog.show();" disabled="#{!loginUser.user.role.addUser}" />
					<p:menuitem value="Usuń" icon="ui-icon-closethick" onclick="confirmation.show()" type="button" disabled="#{rolesList.selectedRole==null || !loginUser.user.role.addRole}"/>
					<p:menuitem value="Zrezygnuj" icon="ui-icon-cancel" onclick="changeToView()" rendered="#{edit}" />
				</p:menubar>
				<p:contextMenu id="contextMenu" for="roles">
        			<p:menuitem value="Usuń" icon="ui-icon-closethick" onclick="confirmation.show()" type="button" disabled="#{!loginUser.user.role.addRole}"/>  
    			</p:contextMenu>
				<p:dataTable id="roles" var="roleView" value="#{rolesList.roles}" rowKey="#{roleView.name}"  
                 selection="#{rolesList.selectedRole}" selectionMode="single" rows="20" style="width: 49%; float: left;"> 
       				<f:facet name="header">  
            			Lista Ról dostępna w Systemie:
        			</f:facet>  
  					<p:ajax event="rowSelect" update=":form"/>
        			
        			<p:column headerText="Nazwa:" >  
            			#{roleView.name}  
        			</p:column>  

  					<f:facet id="tableFooter" name="footer">  
           					<h:outputText value="#{rolesList.roles.size()} wiersze" />  
        			</f:facet> 
    			</p:dataTable>
    			<p:confirmDialog id="confirmDialog" message="Na pewno usunąć role?"  
                				header="Usuwanie..." severity="alert" widgetVar="confirmation">  
        			<p:commandButton id="confirm" value="Tak" update="msgs" oncomplete="confirmation.hide()"  
						                    actionListener="#{rolesList.selectedRole.deleteRole()}" />  
        			<p:commandButton id="decline" value="Nie" onclick="confirmation.hide()" type="button" />   
			    </p:confirmDialog>
			    <p:panel  header="Szczegóły Roli: #{rolesList.selectedRole.name}" style="width: 49%; float: right;" rendered="#{rolesList.selectedRole != null}">
						  <h:panelGrid id="rolePanel" columns="2" style="margin-left: auto; margin-right: auto;">  
            				<ui:remove><!-- list of roles --></ui:remove>
            				<h:outputText value="Dodawanie Faktur: " />  
            				<p:selectBooleanCheckbox value="#{rolesList.selectedRole.addInvoice}" disabled="#{!edit}" > <p:ajax update="form"/>  </p:selectBooleanCheckbox>
            				<h:outputText value="Przeglądanie Faktur: " />  
            				<p:selectBooleanCheckbox value="#{rolesList.selectedRole.viewInvoice}" disabled="#{!edit}"/>
            				<h:outputText value="Dodawanie Produktów: " />  
            				<p:selectBooleanCheckbox value="#{rolesList.selectedRole.addProduct}" disabled="#{!edit}"/>
            				<h:outputText value="Przeglądanie Produktów: " />  
            				<p:selectBooleanCheckbox value="#{rolesList.selectedRole.viewProduct}" disabled="#{!edit}"/>
            				<h:outputText value="Dodawanie Paragonów: " />  
            				<p:selectBooleanCheckbox value="#{rolesList.selectedRole.addReciept}" disabled="#{!edit}"/>
            				<h:outputText value="Przeglądanie Paragonów " />  
            				<p:selectBooleanCheckbox value="#{rolesList.selectedRole.viewReciept}" disabled="#{!edit}"/>
            				<h:outputText value="Dodawanie Faktur Zakupu: " />  
            				<p:selectBooleanCheckbox value="#{rolesList.selectedRole.addBuyInvoice}" disabled="#{!edit}"/>
            				<h:outputText value="Przeglądanie Faktur Zakupu: " />  
            				<p:selectBooleanCheckbox value="#{rolesList.selectedRole.viewBuyInvoice}" disabled="#{!edit}"/>
            				<h:outputText value="Dodawanie Ról: " />  
            				<p:selectBooleanCheckbox value="#{rolesList.selectedRole.addRole}" disabled="#{!edit}"/>
            				<h:outputText value="Przeglądanie Ról: " />  
            				<p:selectBooleanCheckbox value="#{rolesList.selectedRole.viewRole}" disabled="#{!edit}"/>
            				<h:outputText value="Dodawanie Kontrahentów: " />  
            				<p:selectBooleanCheckbox value="#{rolesList.selectedRole.addContractor}" disabled="#{!edit}"/>
            				<h:outputText value="Przeglądanie Kontrahentów: " />  
            				<p:selectBooleanCheckbox value="#{rolesList.selectedRole.viewContractor}" disabled="#{!edit}"/>
            				<h:outputText value="Dodawanie Uzytkowników: " />  
            				<p:selectBooleanCheckbox value="#{rolesList.selectedRole.addUser}" disabled="#{!edit}"/>
            				<h:outputText value="Przeglądanie Użytkowników: " />  
            				<p:selectBooleanCheckbox value="#{rolesList.selectedRole.viewUser}" disabled="#{!edit}"/>
            				<h:outputText value="Dodawanie Magazynow: " />  
            				<p:selectBooleanCheckbox value="#{rolesList.selectedRole.addWarehause}" disabled="#{!edit}"/>
            				<h:outputText value="Przeglądanie Magazynow: " />  
            				<p:selectBooleanCheckbox value="#{rolesList.selectedRole.viewWarehause}" disabled="#{!edit}"/>
            				<h:outputText value="Dodawanie WZ: " />  
            				<p:selectBooleanCheckbox value="#{rolesList.selectedRole.addDelivery}" disabled="#{!edit}"/>
            				<h:outputText value="Przeglądanie WZ: " />  
            				<p:selectBooleanCheckbox value="#{rolesList.selectedRole.viewDelivery}" disabled="#{!edit}"/>
				        </h:panelGrid>
				        <p:commandButton update="msgs" value="#{msg.save}" action="#{rolesList.selectedRole.updateRole()}" rendered="#{edit}"/>
					</p:panel>
					<p:remoteCommand name="changeToView" update="form" action="#{rolesList.refreshList()}">  
        				<f:setPropertyActionListener value="#{false}" target="#{edit}"  />
    				</p:remoteCommand>
					<p:remoteCommand name="changeToEdit" update="form">  
        				<f:setPropertyActionListener value="#{true}" target="#{edit}" />  
    				</p:remoteCommand> 
    		</h:form>
    		<ui:insert name="addRole">
    				<ui:include src="/faces/sections/addRole.xhtml" />
    		</ui:insert>
			</ui:define>
		</ui:composition>
	</body>
</html>